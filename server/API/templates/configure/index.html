
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<style>
  .configuration-box {
    width: 800px;
  }
  
  .page-box {
    box-shadow: 0px 1px 4px 0px rgba(0,0,0,0.2);
    padding: 20px;
    margin: 10px;
  }

  .config-box {
    box-shadow: 0px 1px 4px 0px rgba(0,0,0,0.2);
    padding: 20px;
    margin: 10px;
  }

  .section {
    margin: 10px 0;
  }

  .section-header {
    border-bottom: 1px black solid;
    font-size: larger;
    margin-bottom: 15px;
    padding-bottom: 5px;
  }

  .radio-box {
    margin-right: 10px;
  }

  .radio-box input {
    margin-right: 10px;
  }

  .layout-box {
    display: inline-block;
    border: 1px black solid;
    height: 50px;
    width: 50px;
  }
</style>

<div class="configuration-box">
  <div class="page-box">
  </div>
  
  <div class="config-box">
    <!-- Bid strategy -->
    <div class="section">
      <div class="section-header">Bid Strategy</div>
      <div>
	<span class="radio-box">
	  <input type="radio" name="strategy" value="0">Bid Strategy 1
	</span>
      </div>
      <div>
	<span class="radio-box">
	  <input type="radio" name="strategy" value="1">Bid Strategy 2
	</span>
      </div>
    </div>
    
    <!-- Black/White list -->
    <div class="section">
      <div class="section-header">Site control</div>
      <div id="whitelist">
	<span class="radio-box">
	  <input type="radio" name="listing" value="whitelist">Whitelist
	</span>
	<input type="text" size="120">
      </div>
      <div id="blacklist">
	<span class="radio-box">
	  <input type="radio" name="listing" value="blacklist">Blacklist
	</span>
	<input type="text" size="120 disabled">
      </div>
    </div>
    
    <!-- Layout option -->
    <div class="section">
      <div class="section-header">Layout</div>
      <div>
	<span class="radio-box">
	  <input type="radio" name="layout" value="0">Single
	</span>
      </div>
      <div>
	<span class="radio-box">
	  <input type="radio" name="layout" value="1">Multiple
	</span>
      </div>
      <div>
	<span class="radio-box">
	  <input type="radio" name="layout" value="2">Many
	</span>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  var fakeConfig1 = {
    "bid_strategy": 0,
    "whitelist": "whitelist_site_1",
    "blacklist": "",
    "layout": 0
  }

  var fakeConfig2 = {
    "bid_strategy": 0,
    "whitelist": "whitelist_site_1, whitelist_site_2",
    "blacklist": "",
    "layout": 1
  }

  var fakeConfig3 = {
    "bid_strategy": 0,
    "whitelist": "",
    "blacklist": "blacklist_site_1",
    "layout": 0
  }

  var fakePage1 = [
    {"traffic_percentage": 10.0, "name": "Configuration 1", "bidding_approach": 0, "page": 1, "layout_approach": 0, "white_list": "whitelist_site_1", "id": 0, "black_list": ""},
    {"traffic_percentage": 20.0, "name": "Configuration 2", "bidding_approach": 1, "page": 1, "layout_approach": 1, "white_list": "", "id": 1, "black_list": ""},
    {"traffic_percentage": 70.0, "name": "Configuration 3", "bidding_approach": 0, "page": 1, "layout_approach": 2, "white_list": "", "id": 2, "black_list": "blacklist_site_1"}
  ]

  function createPage() {
    var fakeCreatePageResposne = {
      "status": "ok",
      "data": {
        "p_id": "0",
      },
      "error": ""
    }
  }

  function readPageList() {

  }

  function readPage(page) {

  }

  function savePage(page) {

  }

  function createConfig(page) {
    var fakeCreateConfigResponse = {
      "status": "ok",
      "data": {
        "id": 0,
        "bid_strategy": 0,
        "whitelist": "whitelist_site_1, whitelist_site_2",
        "blacklist": "",
        "layout": 0
      },
      "error": ""
    }
  }

  function enableAndSetList(list_name, val) {
    $("input[name='listing'][value='" + list_name + "']").prop("checked", true);
    $("#" + list_name + " input[type='text']").val(val);
  }

  function disableList(list_name) {
      $("#" + list_name + " input[type='text']").prop("disabled", true);
  }

  function loadConfig(config) {
    // Select strategy
    $("input[name='strategy'][value='" + config.bidding_approach + "']").prop("checked", true);

    // Select whitelist
    if (!config.black_list) {
      enableAndSetList("whitelist", config.white_list);
      disableList("blacklist");
    } else {
      enableAndSetList("blacklist", config.black_list);
      disableList("whitelist");
    }

    // Select layout
    $("input[name='layout'][value='" + config.layout_approach + "']").prop("checked", true)
  }

  function saveConfig(page, config) {

  }

  function createConfiguration(id, name, traffic) {
    var configuration = $('<div><span class="radio-box"><input type="radio" name="config" value="' + id + '">' + name + '</span><input type="text" size="3" value="' + traffic + '" style="text-align: center"></div>');
    $(".page-box").append(configuration);
    configuration.change(function() { loadConfiguration(fakePage1, id); });
  }

  function selectConfiguration(name) {
    $("input[name='config'][value='" + name + "']").prop("checked", true);
  }

  function loadConfiguration(page, id) {
    selectConfiguration(id);

    for (var i = 0; i < page.length; i++) {
      if (page[i].id == id) {
        loadConfig(page[i]);
      }
    }
  }

  for (var i = 0; i < fakePage1.length; i++) {
    createConfiguration(fakePage1[i].id, fakePage1[i].name, fakePage1[i].traffic_percentage);
  }

  loadConfiguration(fakePage1, "0");
</script>
{% endblock %}
